{% extends 'base.html.twig' %}

{% block title %}Accueil - À Table !{% endblock %}

{% block stylesheets %}
{{ parent() }}
<link rel="stylesheet" href="{{ asset('styles/home.css') }}">
{% endblock %}

{% block body %}
<section class="home">
  <h1>Bienvenue sur <span>À Table !</span></h1>
  <p class="subtitle">Découvrez nos meilleures recettes partagées par la communauté</p>

  {% if app.user %}
  <div class="add-recipe-container">
    <a href="{{ path('app_recipe_new') }}" class="btn btn-add">Ajouter une recette</a>
  </div>
  {% endif %}

  <div class="filter-buttons">
    <button data-category="all" class="filter active">Toutes</button>
    <button data-category="entrée" class="filter">Entrées</button>
    <button data-category="plat" class="filter">Plats</button>
    <button data-category="dessert" class="filter">Desserts</button>
    <button data-category="rapide" class="filter">Rapides (-15min)</button>
  </div>


  <div id="recipesList" class="recipe-grid">
    {% for recipe in recipes %}
    <div class="recipe-card" data-category="{{ recipe.category ? recipe.category.name|lower : '' }}"
      data-time="{{ recipe.prepTime + recipe.cookTime }}" data-prep="{{ recipe.prepTime }}">

      <a href="{{ path('app_recipe_show', { id: recipe.id }) }}">
        {% if recipe.imageUrl %}
        <img src="{{ recipe.imageUrl }}" alt="{{ recipe.title }}">
        {% else %}
        <div class="no-image">Pas d’image</div>
        {% endif %}
      </a>
      <div class="recipe-content">
        <h2>{{ recipe.title }}</h2>
        <p>{{ recipe.description|slice(0, 90) ~ '...' }}</p>
        <div class="recipe-meta">
          <span>⏱️ {{ recipe.prepTime + recipe.cookTime }} min</span>
          {% if recipe.category %}
          <span class="category">{{ recipe.category.name }}</span>
          {% endif %}
        </div>
        <a href="{{ path('app_recipe_show', { id: recipe.id }) }}" class="btn">Voir la recette</a>
      </div>
    </div>
    {% else %}
    <p>Aucune recette publiée pour le moment.</p>
    {% endfor %}
  </div>
</section>

{# ✅ Script de filtrage #}
<script defer src="{{ asset('scripts/filter.js') }}"></script>

{% endblock %}