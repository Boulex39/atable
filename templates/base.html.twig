<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      {% block title %}À table!!!{% endblock %}
    </title>

    {# CSS global (header, footer…) #}
    <link rel="stylesheet" href="{{ asset('styles/base.css') }}">
    {% block stylesheets %}{% endblock %}
  </head>

  <body>
    {# ✅ Déclaration de la variable AVANT d’utiliser isAuthRoute #}
    {% set route = app.request.attributes.get('_route') %}
    {% set isAuthRoute = route in ['app_login', 'app_register'] %}

    {# ---------- HEADER ---------- #}
    <header class="site-header">
      <div class="logo-area">
        <img src="{{ asset('images/logo.png') }}" alt="Logo À table!!!">
        <h1><a href="{{ path('app_home') }}">À table!!!</a></h1>
      </div>

      {# ✅ On utilise la classe dynamique ici #}
      <nav class="user-area {{ isAuthRoute ? 'is-hidden' : '' }}">
        {% if app.user %}
          <span>Bienvenue <strong>{{ app.user.username ?: app.user.email }}</strong></span>
          {# <a href="{{ path('app_profile') }}">Mon profil</a> #}
          <a href="{{ path('app_logout') }}">Déconnexion</a>
        {% else %}
          <a href="{{ path('app_login') }}">Connexion</a>
          <a href="{{ path('app_register') }}">Inscription</a>
        {% endif %}
      </nav>
    </header>

    <main class="site-main">
      {% block body %}{% endblock %}
    </main>

    <footer class="site-footer">
      <p>
        <img src="{{ asset('images/logo.png') }}" alt="Logo" class="footer-logo">
        © {{ "now"|date("Y") }} À table!!! — Tous droits réservés.
      </p>
    </footer>

    {% block javascripts %}{% endblock %}
  </body>
</html>

